---
  - name: getmykernel
    hosts: web
    vars:
      - goodkernel: 3.10.0-693.17.1.el7.x86_64

  - tasks:
  
      - name: Get_Kernel_Version
        command: "uname -r"
        register: mykernel
        tags: data_collection

      - name: Feedback
        command: "echo {{mykernel}}"
        tags: feedback

      - name: Compare
        yum:
          name: kernel-3.10.0-693.17.1.el7.x86_64
          state: present
        when: mykernel.rc != {{ goodkernel }}
        tags: Action
